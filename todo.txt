stun1.p2pd.net has only 1 IPv4 / IPv6.
It needs 2 so it can be used as a 'change' server. There's only one offical p2pd server at the moment for that.

http client library doesnt work well
[

    clean up long pipe open func -- split into funcs
signaling messa

make zombie proc stuff more robust

create tests for thousands of uses of key components of the software like STUN
to uncover that the software cleans up properly. all successive tests should
succeed. this is designed to uncover edge cases in long-running processes.
equivalent to durability testing in regular product testing.

trying write to close socket for MQTT?
    [TRYING WRITE TO CLOSED SOCKET]

punch double close found:
  File "/home/x/projects/p2pd/src/p2pd/demo/__main__.py", line 113, in main
    await stop_nodes_option(nodes)
  File "/home/x/projects/p2pd/src/p2pd/demo/menu.py", line 211, in stop_nodes_option
    await n.close()
  File "/home/x/projects/p2pd/src/p2pd/node/node.py", line 99, in close
    await node_stop(self)
  File "/home/x/projects/p2pd/src/p2pd/node/node_stop.py", line 36, in node_stop
    await pipe.close()
  File "/home/x/projects/p2pd/src/p2pd/traversal/plugins/tcp_punch/punch_client.py", line 211, in close
    await self.pipe.close()
  File "/home/x/projects/p2pd/src/p2pd/traversal/plugins/tcp_punch/punch_process.py", line 162, in close_patch
    await pipe_close()
  File "/home/x/projects/p2pd/src/p2pd/net/pipe/pipe_events.py", line 374, in close
    raise AlreadyClosedError()
p2pd.errors.AlreadyClosedError


Windows: Requires obscure socket options (IP_UNICAST_IF) or specific routing table metrics, and Microsoft's "Strong Host Model" implementation can be finicky.

macOS: Uses IP_BOUND_IF.

when it comes to binding in the punch engine maybe do it before the reuse options are set so that ports already used error out. then set the sock options? or does it matter



todo: 


- actually validate our nic offsets and addring details -- invalid nic offsets crash the node

a sig pipe seems to be disconnecting and the error logger doesnt write all errors

i see this get delta error:

  File "/home/x/projects/p2pd/src/p2pd/nic/nat/nat_utils.py", line 199, in get_delta_value
    if results[i - 1][MAPPED_INDEX] is not None:


refactor out delta test from nat test and load interface, its not that
useful here

clean exiting from processing.

this idea of using offsets for server mqtts in the address
is a bad idea because if the config changes and the server positions change
then the offsets point to the wrong server. there needs to be a
unique, canonical identity for each server.
  dont have time to fix it -- just need to maintain order of servers when
  adding them, the output algorthim will need to take the old list + the new one
  and merge the results into a new list


  File "/home/x/projects/p2pd/src/p2pd/protocol/pnp/pnp_client.py", line 66, in return_resp
    buf = decrypt(self.reply_sk, buf)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/x/projects/p2pd/src/p2pd/vendor/ecies/__init__.py", line 38, in decrypt
    ephemeral_pk = msg[0:33]
                   ~~~^^^^^^

just make sure proto and node and plugin cant crash on invalid input
port turn plugin to new plugin

add the deterministic mappings
  change the sock selection algorithm based on a recv byte

  need to eventually integrate the server monitoring stuff
    -- and show freshness of servers in demo

  make the final changes and then focus the next few weeks on stability and making the software work without crashing